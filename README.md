![IMG_7039](https://github.com/user-attachments/assets/f73fa648-31b9-47ec-b195-29c7eed49437)
# 松風 / hiyokochan_n11 ビルドガイド
hiyokochan_n11/松風は以下の特徴を備えるマクロパッドです。
- テンキー配列の11キー
- 3つのロータリーエンコーダー（プッシュボタン付き）
- ３つのトグルスイッチによる機能変更（レイヤー変更）
- 現在の機能把握に便利なLEDインジケーター
- 自由に柄など（0.5mm以下の紙など）をあしらえる額縁プレート（松風のみ）
- ※作例では千代切り紙（バックストリートファクトリー製）を使用した例です。キットには同梱されません。  

ファームウェアはVial対応です。  

vialのソフトウェアから自由にキーマップを変更可能です。




## 必要な物

### キット付属のもの

部品|個数
--|--
hiyokochan_n11/松風 基板|x1
トッププレート（アクリル）|x1
ミドルプレート上|x1
ミドルプレート下|x1
ボトムプレート（アクリル）|x1

### 各自用意するもの
部品|個数
--|--
RP2040-ZERO|x1
MX用スイッチソケット|x11
SK6812MINI-E |x14
Millmax |x15
高さ2.0mmコンスルー(12ピン) |x2
SMDダイオード |x14
EC12互換ロータリーエンコーダ(プッシュスイッチ付き)※遊舎工房さんの高さ17.5mmの物を想定 |x3
チップ抵抗 2012 1KΩ |x2
MOSFET 50V300mA BSS138 |x1
トグルスイッチ|x3
スペーサー（9mm）|x8
M2ネジ（3−5mm）|x8
M2ネジ（5-8mm）|x8
MXキースイッチ |x11
MXキーキャップ |x11
スタビライザー（２U）|ｘ１
ロータリーエンコーダーノブ（直径17mmくらいまで）|x3
ゴム脚 |x2〜４

部品はTALPKEYBOARDさん、遊舎工房さん、秋月電子通商さん、マルツオンラインさんで調達しています。<br/>
<br/>
<br/>
## 組み立て
基板部分は松風として解説していきます。hiyokochan_n11は基板共用なので全く同じです。<br/>
<br/>
写真でマイコンが既に付いているものがありますが、組み立て上確認しながらやりたい場合は先にマイコンのはんだ付けをしてから作業すると確実になります。<br/>
但し、はんだ付けに慣れていない場合は、マイコンを付けた状態でLEDやSMDダイオードなど細かい部品は取り付け辛い場合があるため、ここではマイコンを付けない状態を前提として説明をしていきます。

![IMG_6974](https://github.com/user-attachments/assets/49af0c97-d4c3-4640-bef5-6b61a42c7d46)

LED→SMDダイオード→スイッチソケットの順ではんだ付けします。<br/>
<br/>
<br/>
<br/>
### 1.LEDの取り付け
レベルシフト回路にチップ抵抗とMOSFETをはんだ付け→LEDのはんだ付けの準で処理していきます。
#### 1-1.チップ抵抗、MOSFETの取り付け
![IMG_6975](https://github.com/user-attachments/assets/915f73e8-3a22-4d67-ae6d-2d71322a0dd8)
<br/>
<br/>
<br/>

このチップ抵抗と
![IMG_6976](https://github.com/user-attachments/assets/cf97941b-9ee8-4c10-bf84-435638d50abd)
<br/>
<br/>
このMOSFETを基板にはんだ付けしていきます。
![IMG_6977](https://github.com/user-attachments/assets/cacae60c-cd6c-48a1-9984-fdc310d2eeee)
<br/>
<br/>
<br/>

基板裏面の赤枠の部分にはんだ付けしていきます。
![IMG_6978](https://github.com/user-attachments/assets/d46dc75a-036a-4bf0-bdeb-e56670230e30)
![IMG_6978](https://github.com/user-attachments/assets/904d63b0-3a59-4903-be75-18168b018219)
<br/>
<br/>

フラックスを塗布してから青枠のように片側に予備はんだをしていきます。
はんだごてにごく少量はんだを乗せてからパッドにこて先をあて、こて先を少し立てるようにするとはんだが流れて乗りやすくなると思います。
![IMG_6980](https://github.com/user-attachments/assets/36eca67b-2711-4263-83fb-180ad9495646)
<br/>
<br/>

チップ抵抗、MOSFETを設置場所の少し横に置き、ピンセットなどで保持してスッと横にスライドできる状態にしておいてから、
予備はんだをこて先で溶かし部品をスライドさせれば上手く付けられると思います。<br/>
スライドさせたら、はんだごてを離し１−２秒ほど部品をそのまま保持すると上手く行きます。<br/>
はんだごてより先に保持した部品を動かさないように気をつけましょう。
![IMG_6981](https://github.com/user-attachments/assets/d2698fca-a977-4286-a89b-c182623f999f)
<br/>
<br/>

片側がきっちり固定できたら反対側もはんだ付けしていきます。<br/>
![IMG_6982](https://github.com/user-attachments/assets/d3e959c9-2cfd-42b4-ada5-93a7c82b3fff)

<br/>
<br/>
<br/>

#### 1-2.LED本体を取り付け
<br/>
<br/>
基板裏面のLED1-LED14の部分にLED本体をはんだ付けしていきます。<br/>

![IMG_6985](https://github.com/user-attachments/assets/fb3317a1-f6a9-45b3-9ced-8fe0db84e212)
<br/>
<br/>
赤枠部分Gndの表記の部分にこれまでの要領と同じに予備はんだをしていきます。
![IMG_6986](https://github.com/user-attachments/assets/cfc7f62b-657e-446c-8aac-ce780027e952)
<br/>
<br/>
LED本体オレンジ枠のように切り欠きの部分と予備はんだをしたGndの部分を合わせるようにLEDを設置します。
![IMG_6987](https://github.com/user-attachments/assets/92e451f6-9ef9-4ca4-97b9-82680681c663)
<br/>
<br/>
設置をするとこのようになります。
![IMG_6988](https://github.com/user-attachments/assets/8cbd83dc-d4f7-4b57-ae28-24f5f5b7a637)
<br/>
<br/>
ピンセットなどでLED本体をしっかり固定し、はんだごてで予備はんだを溶かしてはんだ付けします。<br/>
しっかり固定していればはんだが溶けると自然と水平になるので、まっすぐになっていることを確認したらはんだごてを離します。<br/>
この際もLED本体は固定したままにし、はんだごてを離して1−2秒してから固定を解除するようにするとうまく行きます。<br/>
水平になっていなかったりズレたまま固定してしまった場合は、慌てず少し間を置いてから再度ピンセットなどでしっかりと固定した状態ではんだを温め直して修正してください。<br/>
<br/>
<br/>

同じ要領で全てのLEDのGnd部とLED本体の切り欠き部をはんだ付けしていきます。
![IMG_6989](https://github.com/user-attachments/assets/4b3bf301-e07d-4d0d-8c74-0dbf4d4809e7)
<br/>
<br/>

続けてDIｎ、DOut、VCCというように順番にはんだ付けしていきます。
はんだごてにはんだを乗せてからパッドに当てピンの根本から滑らすようにすると綺麗にできると思います。
長い間当てすぎないようにしましょう。1−2秒は大丈夫な気がします。
![IMG_6991](https://github.com/user-attachments/assets/de56f8a9-e921-4349-b2f1-1f280d11ef41)

<br/>
<br/>

### 2.SMDダイオードの取り付け
<br/>
<br/>
SMDダイオードをはんだ付けしていきます。<br/>

SMDダイオードには図の赤枠内のように縦線が入っています。

![406658558-03dcead0-b42c-49c8-963d-3cf0ec3464ec](https://github.com/user-attachments/assets/c20f0e98-ccdc-44d6-b3e5-5fca8e272cee)
<br>
<br>
基板緑枠内にも同じように縦線が入っている場所があります。
![IMG_6993](https://github.com/user-attachments/assets/f7f76421-2a06-4c73-84a7-74037d2cc11e)
<br/>
<br/>
予備はんだをしたら・・
![IMG_6994](https://github.com/user-attachments/assets/5b08fded-789e-4359-ad67-5e2ae09606b3)
<br/>
<br/>
その縦線と、緑枠内の基板上の縦線の向きが合うようにSMDダイオードを配置します。
![IMG_6995](https://github.com/user-attachments/assets/e4df4da0-299c-4268-bf1b-c33f2a7f1948)
<br/>
<br/>
チップ抵抗の時と同じ要領で予備はんだを溶かし、SMDダイオードをスライドさせてはんだ付けします。
![IMG_6996](https://github.com/user-attachments/assets/d39a79d9-5353-4875-be26-26d40d783d92)
<br/>
<br/>
LEDの時と同じ要領で縦線の向きに注意しながら全てのSMDダイオードの片側をはんだ付けしていきます。<br/>
それが出来たら反対側もはんだ付けしていきます。
![IMG_6997](https://github.com/user-attachments/assets/b4c03a3a-a197-48af-9ec3-1cb1e3cf96f7)
<br/>
<br/>

### 3.トグルスイッチの取り付け
<br/>
<br/>

トグルスイッチをはんだ付けしていきます。３つ付けます。
![IMG_6999](https://github.com/user-attachments/assets/fbf53ff5-9738-4306-8a47-0292efc8cb3e)
<br/>
<br/>

基板表に取り付け、裏面からはんだ付けしていきます。<br/>
基板表面、TG1,TG2,TG3にそれぞれ１つずつ順番に付けていきます。<br/>
![IMG_7001](https://github.com/user-attachments/assets/de0527ea-8507-435b-b950-60c800adbc39)
<br/>
<br/>
裏面にフラックスを塗布したら、表面からトグルスイッチを基板の穴に合わせ差し込みます。<br/>
まっすぐ傾きがないように基板に対して水平にして固定（テープなどでも可）します。<br/>
![IMG_7002](https://github.com/user-attachments/assets/b0365251-a424-47e5-9c57-f22117c9f95b)
<br/>
<br/>
はんだごてにはんだを少量乗せて・・・
![IMG_7003](https://github.com/user-attachments/assets/3ad38898-30b8-43a6-ae3c-565abb9efc1c)
<br/>
<br/>
裏側の真ん中のピンにはんだを流し込みます<br/>
この時、押し当てたこて先の力でスイッチが斜めにならないようにしっかりと固定して流し込んでください。<br/>
テープなどでガチガチに固めてもよいですが、私は指で上下をしっかり挟んでから中空で流し込んでいます。<br/>
はんだを乗せたこて先でランドを少し温めてからこて先を立てるようにすると、スッと流れていくので指で押さえながらでも可能です。<br/>
フラックスをしっかり塗布しておけばできるはず。<br/>
はんだごてによる火傷に十分注意して最新の注意を払って行ってください。<br/>
![IMG_7004](https://github.com/user-attachments/assets/a332b878-1efd-40af-b6ce-bb12f6af366a)
<br/>
<br/>
正面、左右から水平を確認します。
![IMG_7005](https://github.com/user-attachments/assets/28e49aa7-0e30-4993-8e46-6fd7dd068090)
<br/>
<br/>

水平の確認が取れたら同じ要領で左右のピンにもはんだを流し込んで固定していきます。<br/>
水平になっていない場合、こて先で中央ピンのはんだを再度温め直して修正してください。<br/>
はんだが溶けている間は修正ができます。<br/>
ここで修正をしておかないと後からのリカバリーは非常に難しくなるので、水平確認は確実に行いましょう。<br/>
![IMG_7006](https://github.com/user-attachments/assets/1bbd286a-b478-41a3-bcfd-b5204f6d2627)
<br/>
<br/>

３つのピンの固定が出来たら同じ要領、真ん中→水平確認→左右ピンの順番でTG2、TG3もはんだ付けしていきます。
![IMG_7007](https://github.com/user-attachments/assets/5a849d9c-f1d7-4011-94bb-4814b2ea1ded)
<br/>
<br/>


### 4.ロータリーエンコーダーの取り付け
<br/>
<br/>

#### 4-１.Millmaxの取り付け
<br/>
<br/>
Millmaxを１つのロータリーエンコーダーに対して５つ、３つのロータリーエンコーダーを取り付けるので計15個はんだ付けしていきます。<br/>
非常に小さい部品かつ、そこそこ高価なのでなくさないように気をつけて作業してください。<br/>

![IMG_7010](https://github.com/user-attachments/assets/15054044-bcfc-4493-9579-a3180693c7cb)

<br/>
<br/>
オレンジ枠（１つのロータリーエンコーダーの取り付け部）内の、青枠内の上２つ、下３つの穴に”表面”から部品を差し込みます。<br/>
表裏間違えると取り付け出来なくなるので注意してください。<br/>

![IMG_7011](https://github.com/user-attachments/assets/e36241b5-aa96-4afe-8dfd-1e27269ce099)
<br/>
<br/>

こちらは裏側<br/>
黄色枠内−裏側の穴にフラックスを塗布します。<br/>
![IMG_7012](https://github.com/user-attachments/assets/11b46d1d-4b8b-4e46-94b3-69721f66a9a2)
<br/>
<br/>

こちらは表面<br/>
緑枠内−表側の穴に部品を合計5個差し込みます。<br/>
![IMG_7013](https://github.com/user-attachments/assets/0c6fc2dc-d63f-45bb-a84b-1522a1c186a7)
<br/>
<br/>
差し込めたら裏向きにしても外れないようにマスキングテープなどでしっかり固定します。<br/>
![IMG_7014](https://github.com/user-attachments/assets/cf45bb77-c360-4d3c-85c7-e587d2dc0749)
<br/>
<br/>
上下両方とも固定します。<br/>
![IMG_7015](https://github.com/user-attachments/assets/cadc67cd-a510-4f50-a635-b7565d1d78e1)
<br/>
<br/>
テープで固定出来たら裏返します。<br/>
裏側赤枠内の部品が飛び出ている周りのランド部分にこれまでと同じ要領ではんだを流し込み固定します。<br/>
この際、飛び出ている穴にはんだが入ってしまわないように注意してください。<br/>
差し込めなくなってしまいますので。<br/>
![IMG_7016](https://github.com/user-attachments/assets/80ed164e-756a-4df0-b121-7346a80d914f)
<br/>
<br/>
固定ができたら他の２箇所も同じ要領でMillmaxを取り付け→固定していきます。

<br/>
<br/>

#### 4-2.ロータリーエンコーダー本体の取り付け
<br/>
<br/>

ロータリーエンコーダー本体を取り付けていきます。<br/>
穴の位置に合うように足を多少広げてから刺し込みます。<br/>
差し込む際、上から垂直に力をかけると足が曲がる可能性が高いので、片側をある程度差し込んでからもう片側を調整しながら差し込むと上手くいきます。<br/>
横から見て水平になっているか確認ながらしっかりと差し込みます。<br/>
![IMG_7017](https://github.com/user-attachments/assets/5f861ef2-c253-4738-be6f-531336a1e584)
<br/>
<br/>

同じ要領で他の２つも差し込みます。
![IMG_7018](https://github.com/user-attachments/assets/d1ad13f0-e899-47e5-9056-484f9c8df659)
<br/>
<br/>
ロータリーエンコーダーは脱着が可能ですが、無理やり外したりすると足が折れてしまう可能性があるため頻繁な差し替えは推奨していません。<br/>
使い方によってクリック感のないタイプのエンコーダーに切り替えたり、エンコーダーの位置に普通のスイッチが必要になった際取り外せるようにした仕様です。<br/>
また、使用するエンコーダーノブによっては軸がタイトで無理やり引き抜こうとするとエンコーダー自体もすっぽ抜けてしまう可能性もあるので、注意して取り外しするようにしてください。<br/>
<br/>
<br/>

### 5.マイコン(RP2040−ZERO)の取り付け
<br/>
<br/>
マイコンのRP2040−ZEROを取り付けていきます。<br/>
![IMG_7120](https://github.com/user-attachments/assets/7259844b-f366-4bb6-8341-9d14546728a3)


はじめにコンスルーを取り付けます。<br/>
![IMG_7121](https://github.com/user-attachments/assets/b1f98b22-a8a5-48bc-9606-8eb73b9180d7)

マイコンのピンの並びに合うようにコンスルーをニッパーなどで切断してマイコンをはんだ付けする土台を作っていきます。<br/>
コンスルーには向きがあります。写真の緑枠内ように小さい四角の窓が空いており、コンスルーを平らに置いたとき上より、赤線、青線が示すとおり下よりといったように方向性があります。<br/>
![IMG_7127](https://github.com/user-attachments/assets/a55d3c82-0a8f-4a20-9688-ec92b5cdaef3)


その四角の窓が下よりの向きになるようにコンスルーの向きを整えます。<br/>
基板を裏向きにします。<br/>
下向きの窓が基板側になるようにコンスルーを基板の穴に差し込みます。<br/>
このとき、窓がある側面を同じ方向に揃えて差し込みます。写真では手前になるようにしています。揃っていればどちらでも構いません。（たぶん・・）<br/>
※コンスルーは基板側にははんだ付けしません。はんだ付けしてしまっても問題ありませんが、コンスルーである意味がなくなってしまいます。（取り外せるというのがメリット）<br/>
基板に印刷された番号とマイコンの番号を合わせるようにマイコンを差し込みます。BOOT、RESETスイッチがあるほうが裏目（LEDやスイッチソケットがはんだ付けされている面）となります。<br/>
向きに注意してください。<br/>
このとき、フラックスを塗布してから差し込むようにしておくと綺麗にできると思います。<br/>
パッドをはんだごてで温めはんだを流し込んでいきます。<br/>
順番はどこからでも問題ないですが、順番にやっていったほうがやり易いかと思います。<br/>


